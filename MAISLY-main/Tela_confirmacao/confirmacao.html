<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MAISLY</title>
  <link rel="stylesheet" href="confirmacao.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
</head>
<body theme = light>
  <header>
        <div id="parte1">
            <a href="../Tela_inicio/inicio.html">
                <img src="../imagem/logo.png" height="50" width="180">
            </a>
            <div id="icones">
                <input id="pesquisar" type="text" placeholder="Pesquisar">
                <button class="botaotype especial" onclick="abrirCurtido()">
                    <img src="../imagem/coracao.png">
                </button>
                <button class="botaotype">
                    <img src="../imagem/carrinho.png" onclick="abrirCarrinho()">
                </button>
                <a href="../Tela_perfil/perfil.html">
                    <button class="botaotype">
                        <img src="../imagem/pessoalogin.png">
                    </button>
                </a>
            </div>
        </div>
        <div id="parte2"> 
            <button onclick="openMenu()" class="sidebar-icon">
                <i id="icon" class="bi bi-list"></i>
                <span>Menu</span>
            </button>
            <div class="menu-temas">
                <p class="p"> <img src="../imagem/ferramenta.png" id="iconestl"> Temas</p>
                <div class="temas"> 
                <p id="light">Light</p>
                <p id="dark">Dark</p>
                <p id="baixa">Baixa visão</p>
                </div>
            </div>
        <p class="p" id="a">  <img src="../imagem/acesibili.png" id="iconestl">Acessibilidade</p>

        <a href="../tela_ajuda/tela_ajuda.html" class="p">
            <img src="../imagem/ajudasemfundo.png" id="iconestl">
            Ajuda
        </a>

    </div>
    </header>

    <nav id="menutenis">
        <div class="menu">
            <a href="../Tela_produto01/produto1.html"id="block">
                <div id="navtenis">
                    <img src="../imagem/tenis0.jpeg" alt="">
                    <p>Promoções</p>
                </div>
            </a>
            <a href="../Tela_produto02/produto2.html"id="block">
                <div id="navtenis">
                    <img src="../imagem/tenis1.jpeg" alt="">
                    <p>Masculino</p>
                </div>
            </a>
            <a href="../Tela_produto03/produto3.html"id="block">
                <div id="navtenis">
                    <img src="../imagem/tenis2.jpeg" alt="">
                    <p>Feminino</p>
                </div>
            </a>
            <a href="../Tela_produto04/produto4.html"id="block">
                <div id="navtenis">
                    <img src="../imagem/tenis3.jpeg" alt="">
                    <p>Infantil</p>
                </div>
            </a>
            <a href="../Tela_produto05/produto5.html"id="block">
                <div id="navtenis">
                    <img src="../imagem/tenis4.jpeg" alt="">
                    <p>Social</p>
                </div>
            </a>
            <a href="../Tela_produto06/produto6.html"id="block">
                <div id="navtenis">
                    <img src="../imagem/tenis5.jpeg" alt="">
                    <p>Casual</p>
                </div>
            </a>
            <a href="../Tela_produto07/produto7.html"id="block">
                <div id="navtenis">
                    <img src="../imagem/tenis6.jpeg" alt="">
                    <p>Esportivo</p>
                </div>
            </a>
            <a href="../Tela_produto08/produto8.html"id="block">
                <div id="navtenis">
                    <img src="../imagem/tenis7.jpeg" alt="">
                    <p>Sneaker</p>
                </div>
            </a>
        </div>
        <div class="sidebar">
            <a href="../Tela_produto01/produto1.html"><p>Promoções</p></a>
            <a href="../Tela_produto02/produto2.html"><p>Masculino</p></a>
            <a href="../Tela_produto03/produto3.html"><p>Feminino</p></a>
            <a href="../Tela_produto04/produto4.html"><p>Infantil</p></a>
            <a href="../Tela_produto05/produto5.html"><p>Social</p></a>
            <a href="../Tela_produto06/produto6.html"><p>Casual</p></a>
            <a href="../Tela_produto07/produto7.html"><p>Esportivo</p></a>
            <a href="../Tela_produto08/produto8.html"><p>Sneaker</p></a>
        </div>
    </nav>


    <div id="confirmacao">
        <div class="titulo">
            <p>Confirmação de compra</p>
        </div>
        <div id="compras">
            <div class="texto">
                <div class="nomes">
                    <p>Total da compra :</p>
                    <p>Quantidade de itens :</p>
                        <p>Data de envio :</p>
                    <p>Data de entrega :</p>
                </div>
                <div class="respostas">
                  <p id="total-compra">R$ 0,00</p>
                  <p id="qtd-itens">0 item(ns)</p>
                  <p id="data-envio">--/--/----</p>
                  <p id="data-entrega">--/--/----</p>
                </div>

            </div>
            <div class="imagem">
              <div class="imagem-tenis" id="imagens-produtos"></div>
            </div>
        </div>
        <div class="partebaixa">
            <div class="metodo">
                <h3>Métodos de pagamento:</h3>
                <button class="pagamento cartao">Cartão de Crédito</button>
                <button class="pagamento pix">Pix</button>
            </div>   
            <div class="botao">
                <button id="fazer-pedido">Fazer pedido</button>
            </div> 
        </div>
    </div>

<script>
  const temaSalvo = localStorage.getItem('tema');
  if (temaSalvo) {
    document.body.setAttribute('theme', temaSalvo);
  }

  function aplicarTema(tema) {
    document.body.setAttribute('theme', tema);
    localStorage.setItem('tema', tema);
  }

  document.getElementById('dark')?.addEventListener('click', () => aplicarTema('dark'));
  document.getElementById('light')?.addEventListener('click', () => aplicarTema('light'));
  document.getElementById('baixa')?.addEventListener('click', () => aplicarTema('baixa'));

  function openMenu() {
    const menu = document.querySelector(".sidebar");
    const icon = document.getElementById("icon");

    menu.classList.toggle("open");

    if (menu.classList.contains("open")) {
      icon.classList.replace("bi-list", "bi-x-lg");
    } else {
      icon.classList.replace("bi-x-lg", "bi-list");
    }
  }

  function abrirCarrinho() {
    let carrinho = JSON.parse(localStorage.getItem('carrinho')) || [];
    if (carrinho.length > 0) {
      window.location.href = '../Tela_carrinho/carrinho.html';
    } else {
      window.location.href = '../Tela_carrinhovazio/carrinhovazio.html';
    }
  }

  function abrirCurtido() {
    let curtido = JSON.parse(localStorage.getItem('curtido')) || [];
    if (curtido.length > 0) {
      window.location.href = '../Tela_curtido/curtidos2.html';
    } else {
      window.location.href = '../Tela_curtidovazio/curtidovazio.html';
    }
  }

  const carrinho = JSON.parse(localStorage.getItem("carrinho")) || [];

  if (carrinho.length === 0) {
    window.location.href = "../Tela_carrinhovazio/carrinhovazio.html";
  }

  const total = carrinho.reduce((soma, p) => soma + p.preco * p.qtd, 0);
  const totalItens = carrinho.reduce((soma, p) => soma + p.qtd, 0);

  document.getElementById("total-compra").innerText =
    `R$ ${total.toFixed(2)}`;

  document.getElementById("qtd-itens").innerText =
    `${totalItens} item(ns)`;

  function formatarData(data) {
    return data.toLocaleDateString("pt-BR");
  }

  const hoje = new Date();
  const envio = new Date(hoje);
  envio.setDate(hoje.getDate() + 2);

  const entrega = new Date(hoje);
  entrega.setDate(hoje.getDate() + 10);

  document.getElementById("data-envio").innerText = formatarData(envio);
  document.getElementById("data-entrega").innerText = formatarData(entrega);

  const imagens = document.getElementById("imagens-produtos");
  imagens.innerHTML = carrinho.map(p => `
    <img src="${p.img}" alt="${p.nome}">
  `).join('');

document.getElementById("fazer-pedido").addEventListener("click", () => {
  const carrinho = JSON.parse(localStorage.getItem("carrinho")) || [];

  if (carrinho.length === 0) {
    alert("Nenhuma compra encontrada.");
    return;
  }

  const total = carrinho.reduce(
    (soma, p) => soma + p.preco * p.qtd, 0
  );

  const comprovante = {
    dataPedido: new Date().toLocaleDateString("pt-BR"),

    itens: carrinho.map(p => ({
      nome: p.nome,
      quantidade: p.qtd,
      precoUnitario: p.preco,
      subtotal: p.preco * p.qtd
    })),

    totalCompra: total.toFixed(2),
    quantidadeItens: carrinho.reduce((s, p) => s + p.qtd, 0),

    envio: document.getElementById("data-envio").innerText,
    entrega: document.getElementById("data-entrega").innerText
  };

  const json = JSON.stringify(comprovante, null, 2);
  const blob = new Blob([json], { type: "application/json" });
  const url = URL.createObjectURL(blob);

  const a = document.createElement("a");
  a.href = url;
  a.download = "comprovante-compra.json";
  a.click();

  URL.revokeObjectURL(url);

  localStorage.removeItem("carrinho");
  alert("Pedido realizado com sucesso, confira seu comprovante!");
  window.location.href = "../Tela_inicio/inicio.html";
});


</script>

</body>
</html>